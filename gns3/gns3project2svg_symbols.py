import json
import re
import random

# https://github.com/GNS3/gns3-gui/tree/master/resources/symbols

symbols_dict = {"docker_guest.svg": '<g transform="translate(0,0)"> <rect height="5.4088969" style="fill:url(#linearGradient1156);fill-opacity:1;fill-rule:evenodd;stroke:url(#linearGradient1157);stroke-width:0.953444pt" width="38.405891" x="12.350429" y="36.575089" /> <path d="M 0.19287398,54.885213 C -0.67386281,56.46268 1.5579198,59.253939 3.3933636,59.253939 H 62.069027 c 1.55983,0 3.907174,-1.972734 3.200495,-3.328561 L 58.655165,43.235277 C 58.145696,42.257819 57.005954,41.779036 55.881408,41.779036 H 8.9408812 c -0.9273188,0 -1.9091271,0.659255 -2.3470273,1.456241 z" sodipodi:nodetypes="czzzzzzzz" style="fill:url(#linearGradient1140);fill-opacity:1;fill-rule:evenodd;stroke-width:1.44735pt" /> <rect height="39.110481" rx="3.6272225" ry="3.536587" style="fill:url(#linearGradient905);fill-opacity:1;fill-rule:evenodd;stroke-width:1.62827" width="48.220726" x="7.4732022" y="-0.010164791" /> <rect height="24.74659" style="fill:url(#radialGradient1132);fill-opacity:1;fill-rule:evenodd;stroke:url(#linearGradient891);stroke-width:0.965037pt" width="38.813015" x="12.390426" y="6.027596" /> <path d="M 8.5906358,19.782157 8.3772707,34.032521 c -0.034015,2.271721 1.2939851,3.726349 3.6272223,3.744622 l 26.564073,0.208032 2.560391,-5.824968 -29.657881,-0.20803 -0.213363,-12.274036 z" sodipodi:nodetypes="czzccccc" style="fill:url(#linearGradient1146);fill-opacity:1;fill-rule:evenodd;stroke-width:1pt" /> <path d="m 2.7205883,54.675124 c -0.6092061,1.191662 0.1883352,3.300225 2.2495435,3.300225 H 60.179981 c 1.096365,0 2.74625,-1.490239 2.249543,-2.51445 L 57.78047,45.874547 c -0.358101,-0.738395 -1.159196,-1.100073 -1.949605,-1.100073 l -46.9615297,-6e-6 c -0.6517891,0 -1.3418749,0.498018 -1.649663,1.100079 z" sodipodi:nodetypes="czzzzzzzz" style="fill:url(#linearGradient1144);fill-opacity:1;fill-rule:evenodd;stroke-width:1pt" /> <path d="m 19.010905,6.5904681 23.41577,-0.2955955 c 3.614617,-0.04563 8.105459,3.5348459 8.105459,7.0942794 V 24.030571 L 18.710703,23.734975 Z" sodipodi:nodetypes="czzccc" style="fill:url(#linearGradient2635);fill-opacity:1;fill-rule:evenodd;stroke-width:1pt" /> <path d="m 41.29338,29.915511 -20.983154,0.06229 c -3.239101,0.0096 -7.230949,-3.237336 -7.199191,-6.426589 l 0.09495,-9.534706 28.509354,0.540133 z" sodipodi:nodetypes="czzccc" style="fill:url(#linearGradient2637);fill-opacity:1;fill-rule:evenodd;stroke-width:1pt" /> <g transform="matrix(0.07160825,0,0,0.07160825,15.772378,2.2486319)" > <path style="fill:#4d4d4d;fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 242.133,168.481 h 47.146 v 48.194 h 23.837 c 11.008,0 22.33,-1.962 32.755,-5.494 5.123,-1.736 10.872,-4.154 15.926,-7.193 -6.656,-8.689 -10.053,-19.661 -11.054,-30.476 -1.358,-14.71 1.609,-33.855 11.564,-45.368 l 4.956,-5.732 5.905,4.747 c 14.867,11.946 27.372,28.638 29.577,47.665 17.901,-5.266 38.921,-4.02 54.701,5.088 l 6.475,3.734 -3.408,6.652 c -13.345,26.046 -41.246,34.113 -68.524,32.687 -40.817,101.663 -129.68,149.794 -237.428,149.794 -55.666,0 -106.738,-20.81 -135.821,-70.197 l -0.477,-0.807 -4.238,-8.621 C 4.195,271.415 0.93,247.6 3.145,223.803 l 0.664,-7.127 h 40.315 v -48.194 h 47.143 v -47.145 h 94.292 V 74.191 h 56.574 z" /> <g style="display:none" display="none" > <path style="display:inline;fill:#394d54" inkscape:connector-curvature="0" display="inline" d="m 61.093,319.89 c 6.023,0 11.763,-0.157 17.219,-0.464 0.476,-0.026 0.932,-0.063 1.402,-0.092 0.005,-0.002 0.008,-0.002 0.012,-0.002 13.872,-0.855 25.876,-2.708 35.902,-5.57 0.002,-0.002 0.004,-0.002 0.006,-0.002 1.823,-0.521 3.588,-1.07 5.282,-1.656 1.894,-0.657 2.896,-2.725 2.241,-4.618 -0.656,-1.895 -2.722,-2.899 -4.618,-2.24 -12.734,4.412 -29.535,6.842 -50.125,7.298 -0.002,0 -0.004,0 -0.005,0 -10.477,0.232 -21.93,-0.044 -34.352,-0.843 0,0 0,0 -0.001,0 -0.635,-0.038 -1.259,-0.075 -1.9,-0.118 -1.995,-0.128 -3.731,1.374 -3.869,3.375 -0.136,1.999 1.376,3.73 3.375,3.866 2.537,0.173 5.03,0.321 7.49,0.453 0.392,0.021 0.77,0.034 1.158,0.054 v 0 c 7.256,0.366 14.194,0.559 20.783,0.559 z" /> </g> <g > <path style="fill:#ffffff;fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 86.209,179.744 h 3.227 v 34.052 h -3.227 z m -6.189,0 h 3.354 v 34.052 H 80.02 Z m -6.192,0 h 3.354 v 34.052 h -3.354 z m -6.192,0 h 3.354 v 34.052 h -3.354 z m -6.19,0 H 64.8 v 34.052 h -3.354 z m -6.062,0 h 3.224 v 34.052 h -3.224 z m -3.403,-3.406 h 40.858 v 40.86 H 51.981 Z" /> <path style="fill:#ffffff;fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 133.354,132.598 h 3.229 v 34.051 h -3.229 z m -6.189,0 h 3.354 v 34.051 h -3.354 z m -6.192,0 h 3.354 v 34.051 h -3.354 z m -6.192,0 h 3.354 v 34.051 h -3.354 z m -6.188,0 h 3.352 v 34.051 h -3.352 z m -6.062,0 h 3.222 v 34.051 h -3.222 z m -3.407,-3.405 h 40.863 v 40.859 H 99.124 Z" /> <path style="fill:#ffffff;fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 133.354,179.744 h 3.229 v 34.052 h -3.229 z m -6.189,0 h 3.354 v 34.052 h -3.354 z m -6.192,0 h 3.354 v 34.052 h -3.354 z m -6.192,0 h 3.354 v 34.052 h -3.354 z m -6.188,0 h 3.352 v 34.052 h -3.352 z m -6.062,0 h 3.222 v 34.052 h -3.222 z m -3.407,-3.406 h 40.863 v 40.86 H 99.124 Z" /> <path style="fill:#ffffff;fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 180.501,179.744 h 3.225 v 34.052 h -3.225 z m -6.191,0 h 3.355 v 34.052 h -3.355 z m -6.19,0 h 3.354 v 34.052 h -3.354 z m -6.192,0 h 3.354 v 34.052 h -3.354 z m -6.192,0 h 3.354 v 34.052 h -3.354 z m -6.06,0 h 3.222 v 34.052 h -3.222 z m -3.405,-3.406 h 40.861 v 40.86 h -40.861 z" /> <path style="fill:#ffffff;fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 180.501,132.598 h 3.225 v 34.051 h -3.225 z m -6.191,0 h 3.355 v 34.051 h -3.355 z m -6.19,0 h 3.354 v 34.051 h -3.354 z m -6.192,0 h 3.354 v 34.051 h -3.354 z m -6.192,0 h 3.354 v 34.051 h -3.354 z m -6.06,0 h 3.222 v 34.051 h -3.222 z m -3.405,-3.405 h 40.861 v 40.859 h -40.861 z" /> <path style="fill:#ffffff;fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 227.647,179.744 h 3.226 v 34.052 h -3.226 z m -6.19,0 h 3.354 v 34.052 h -3.354 z m -6.192,0 h 3.354 v 34.052 h -3.354 z m -6.192,0 h 3.354 v 34.052 h -3.354 z m -6.189,0 h 3.354 v 34.052 h -3.354 z m -6.063,0 h 3.224 v 34.052 h -3.224 z m -3.405,-3.406 h 40.861 v 40.86 h -40.861 z" /> <path style="fill:#ffffff;fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 227.647,132.598 h 3.226 v 34.051 h -3.226 z m -6.19,0 h 3.354 v 34.051 h -3.354 z m -6.192,0 h 3.354 v 34.051 h -3.354 z m -6.192,0 h 3.354 v 34.051 h -3.354 z m -6.189,0 h 3.354 v 34.051 h -3.354 z m -6.063,0 h 3.224 v 34.051 h -3.224 z m -3.405,-3.405 h 40.861 v 40.859 h -40.861 z" /> <path style="fill:#ffffff;fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 227.647,85.451 h 3.226 v 34.053 h -3.226 z m -6.19,0 h 3.354 v 34.053 h -3.354 z m -6.192,0 h 3.354 v 34.053 h -3.354 z m -6.192,0 h 3.354 v 34.053 h -3.354 z m -6.189,0 h 3.354 v 34.053 h -3.354 z m -6.063,0 h 3.224 v 34.053 h -3.224 z m -3.405,-3.403 h 40.861 v 40.86 h -40.861 z" /> <path style="fill:#ffffff;fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 274.792,179.744 h 3.224 v 34.052 h -3.224 z m -6.19,0 h 3.352 v 34.052 h -3.352 z m -6.194,0 h 3.354 v 34.052 h -3.354 z m -6.19,0 h 3.354 v 34.052 h -3.354 z m -6.192,0 h 3.354 v 34.052 h -3.354 z m -6.062,0 h 3.227 v 34.052 h -3.227 z m -3.403,-3.406 h 40.86 v 40.86 h -40.86 z" /> </g> <path style="fill:#ffffff;fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 137.428,283.445 c 6.225,0 11.271,5.049 11.271,11.272 0,6.225 -5.046,11.271 -11.271,11.271 -6.226,0 -11.272,-5.046 -11.272,-11.271 0,-6.223 5.046,-11.272 11.272,-11.272" /> <path style="fill-rule:evenodd" inkscape:connector-curvature="0" clip-rule="evenodd" d="m 137.428,286.644 c 1.031,0 2.015,0.194 2.923,0.546 -0.984,0.569 -1.65,1.635 -1.65,2.854 0,1.82 1.476,3.293 3.296,3.293 1.247,0 2.329,-0.693 2.89,-1.715 0.395,0.953 0.615,1.999 0.615,3.097 0,4.458 -3.615,8.073 -8.073,8.073 -4.458,0 -8.074,-3.615 -8.074,-8.073 -10e-4,-4.461 3.616,-8.075 8.073,-8.075" /> <path style="fill:#ffffff" inkscape:connector-curvature="0" d="m 167.394,364.677 c -27.916,-13.247 -43.239,-31.256 -51.765,-50.915 -10.37,2.961 -22.835,4.852 -37.317,5.664 -5.457,0.307 -11.196,0.464 -17.219,0.464 -6.942,0 -14.26,-0.205 -21.94,-0.613 25.6,25.585 57.094,45.283 115.408,45.645 4.305,-0.001 8.579,-0.085 12.833,-0.245 z" /> </g> </g>',

                "multilayer_switch.svg": '<g transform="translate(0,0)"> <path d="m 1.8402723,44.565612 v 3.050081 H 44.293781 V 44.565612 H 1.8402723" style="fill:#000000;fill-opacity:0.392157;stroke:none;stroke-width:0.001" /> <path d="M 44.370594,6.1851672 51.194316,1.0980117 51.358819,41.344844 44.266438,47.63069 44.370594,6.1851672" style="fill:#000000;fill-opacity:0.392157;stroke:none;stroke-width:0.001" sodipodi:nodetypes="ccccc" /> <path d="M 0.06250035,5.0439492 V 46.326915 H 44.31814 V 5.0439492 H 0.06250035" style="fill:#6e8caa;fill-opacity:1;stroke:none;stroke-width:0.001" /> <path d="M -0.02841881,5.1647552 5.5982489,0.11782966 50.022311,0.14184042 44.346312,5.1887393 -0.02841881,5.1647552" style="fill:url(#linearGradient9199);fill-opacity:1;stroke:none;stroke-width:0.001" /> <path d="M 44.228586,5.0887264 49.976169,0.12831483 V 41.348635 l -5.747583,4.960412 V 5.0887264" style="fill:#6e8296;fill-opacity:1;stroke:none;stroke-width:0.001" /> <path d="M 17.380994,23.789246 H 5.6713307 v -1.53703 l -3.5916196,3.074057 3.5916196,3.423384 V 27.235915 H 17.380994 v -3.446669" style="fill:#000000;stroke:none;stroke-width:0.001" /> <path d="m 19.767207,21.506989 -8.437846,-8.01118 1.205407,-1.141128 H 7.7131417 v 4.56451 l 1.1808063,-1.141127 8.487046,8.011182 2.386213,-2.282257" style="fill:#000000;stroke:none;stroke-width:0.001" /> <path d="M 23.383427,21.506989 V 10.049138 h 1.599008 l -3.198016,-3.0507696 -3.61622,3.0507696 h 1.599008 v 11.457851 h 3.61622" style="fill:#000000;stroke:none;stroke-width:0.001" /> <path d="m 25.818839,23.789246 8.462446,-8.011182 1.180807,1.141127 v -4.56451 h -4.797027 l 1.180807,1.141128 -8.462445,8.01118 2.435412,2.282257" style="fill:#000000;stroke:none;stroke-width:0.001" /> <path d="m 25.818839,27.235915 h 12.054066 v 1.513742 l 3.247216,-3.423384 -3.247216,-3.074057 v 1.53703 H 25.818839 v 3.446669" style="fill:#000000;stroke:none;stroke-width:0.001" /> <path d="m 23.383427,29.51817 8.462445,8.011181 -1.180807,1.164417 4.797027,-0.372614 v -4.191897 l -1.180807,1.141128 -8.462446,-8.03447 -2.435412,2.282255" style="fill:#000000;stroke:none;stroke-width:0.001" /> <path d="m 19.767207,29.51817 v 11.481141 h -1.599008 l 3.61622,3.027481 3.198016,-3.027481 H 23.383427 V 29.51817 h -3.61622" style="fill:#000000;stroke:none;stroke-width:0.001" /> <path d="m 17.380994,27.235915 -8.487046,8.03447 -1.1808063,-1.141128 v 4.564511 h 4.8216263 l -1.205407,-1.164417 8.437846,-8.011181 -2.386213,-2.282255" style="fill:#000000;stroke:none;stroke-width:0.001" /> <path d="M 17.749996,24.185146 H 6.0895329 v -1.537028 l -3.6162195,3.05077 3.6162195,3.44667 v -1.51374 H 17.749996 v -3.446672" style="fill:#ffffff;stroke:none;stroke-width:0.001" /> <path d="m 20.185408,21.902892 -8.462445,-8.03447 1.230007,-1.141128 H 8.1067438 v 4.587799 l 1.1808063,-1.164416 8.4624459,8.034469 2.435412,-2.282254" style="fill:#ffffff;stroke:none;stroke-width:0.001" /> <path d="M 23.801628,21.902892 V 10.421751 h 1.59901 l -3.222619,-3.0507694 -3.61622,3.0507694 h 1.623609 v 11.481141 h 3.61622" style="fill:#ffffff;stroke:none;stroke-width:0.001" /> <path d="m 26.237042,24.185146 8.437845,-8.034469 1.205406,1.164416 v -4.587799 h -4.846226 l 1.205408,1.141128 -8.437847,8.03447 2.435414,2.282254" style="fill:#ffffff;stroke:none;stroke-width:0.001" /> <path d="m 26.237042,27.631818 h 12.029464 v 1.51374 l 3.247218,-3.44667 -3.247218,-3.05077 v 1.537028 H 26.237042 v 3.446672" style="fill:#ffffff;stroke:none;stroke-width:0.001" /> <path d="m 23.801628,29.914073 8.437847,8.011181 -1.205408,1.141127 4.846226,-0.372613 v -4.215187 l -1.205406,1.141128 -8.437845,-7.987891 -2.435414,2.282255" style="fill:#ffffff;stroke:none;stroke-width:0.001" /> <path d="m 20.185408,29.914073 v 11.434562 h -1.623609 l 3.61622,3.074058 3.222619,-3.074058 h -1.59901 V 29.914073 h -3.61622" style="fill:#ffffff;stroke:none;stroke-width:0.001" /> <path d="M 17.749996,27.631818 9.2875501,35.619709 8.1067438,34.478581 v 4.5878 H 12.95297 l -1.230007,-1.141127 8.462445,-8.011181 -2.435412,-2.282255" style="fill:#ffffff;stroke:none;stroke-width:0.001" /> <path d="m 28.229653,25.885193 -0.0246,-0.302748 -0.0246,-0.349324 -0.0492,-0.302748 -0.0492,-0.302748 -0.0738,-0.326036 -0.0984,-0.30275 -0.123,-0.302748 -0.0984,-0.302748 -0.147601,-0.27946 -0.1476,-0.27946 -0.172202,-0.279459 -0.196801,-0.27946 -0.196799,-0.256172 -0.221402,-0.232883 -0.221402,-0.256172 -0.2214,-0.209593 -0.270602,-0.209596 -0.246001,-0.209595 -0.270602,-0.186305 -0.270602,-0.163019 -0.319801,-0.186307 -0.270602,-0.139729 -0.319802,-0.116443 -0.319802,-0.116441 -0.2952,-0.11644 -0.344403,-0.06987 -0.2952,-0.09315 -0.369004,-0.04658 -0.319802,-0.04658 -0.3444,-0.02329 h -0.319802 v 0 h -0.344402 l -0.319802,0.02329 -0.344402,0.04658 -0.319802,0.04658 -0.344403,0.09315 -0.319801,0.06987 -0.319802,0.11644 -0.319801,0.116441 -0.295201,0.116443 -0.270602,0.139729 -0.319802,0.186307 -0.2952,0.163019 -0.246003,0.186305 -0.2706,0.209595 -0.246003,0.209596 -0.2214,0.209593 -0.246001,0.256172 -0.196801,0.232883 -0.196801,0.256172 -0.196801,0.27946 -0.172203,0.279459 -0.147599,0.27946 -0.147602,0.27946 -0.123,0.302748 -0.123,0.302748 -0.0738,0.30275 -0.0738,0.326036 -0.0738,0.302748 -0.0492,0.302748 v 0.349324 l -0.0246,0.302748 v 0 l 0.0246,0.302748 v 0.326038 l 0.0492,0.326036 0.0738,0.326036 0.0738,0.302748 0.0738,0.302748 0.123,0.302748 0.123,0.302748 0.147602,0.279459 0.147599,0.27946 0.172203,0.27946 0.196801,0.27946 0.196801,0.256171 0.196801,0.232884 0.246001,0.232883 0.2214,0.232884 0.246003,0.209595 0.2706,0.209594 0.246003,0.186307 0.2952,0.163019 0.319802,0.163017 0.270602,0.163019 0.295201,0.139729 0.319801,0.116443 0.319802,0.06986 0.319801,0.09315 0.344403,0.09315 0.319802,0.02329 0.344402,0.06987 0.319802,0.02329 h 0.344402 v 0 h 0.319802 l 0.3444,-0.02329 0.319802,-0.06987 0.369004,-0.02329 0.2952,-0.09315 0.344403,-0.09315 0.2952,-0.06986 0.319802,-0.116443 0.319802,-0.139729 0.270602,-0.163019 0.319801,-0.163017 0.270602,-0.163019 0.270602,-0.186307 0.246001,-0.209594 0.270602,-0.209595 0.2214,-0.232884 0.221402,-0.232883 0.221402,-0.232884 0.196799,-0.256171 0.196801,-0.27946 0.172202,-0.27946 0.1476,-0.27946 0.147601,-0.279459 0.0984,-0.302748 0.123,-0.302748 0.0984,-0.302748 0.0738,-0.302748 0.0492,-0.326036 0.0492,-0.326036 0.0246,-0.326038 0.0246,-0.302748" style="fill:#000000;stroke:none;stroke-width:0.001" /> <path d="m 29.016857,26.653708 -0.0246,-0.302748 -0.0246,-0.326036 -0.0492,-0.326036 -0.0246,-0.326039 -0.0984,-0.302747 -0.0984,-0.302748 -0.0984,-0.302748 -0.123,-0.27946 -0.147602,-0.302748 -0.147599,-0.27946 -0.172202,-0.279459 -0.172201,-0.27946 -0.221402,-0.256172 -0.2214,-0.232883 -0.196801,-0.232884 -0.246001,-0.232881 -0.270602,-0.209596 -0.246,-0.209595 -0.270602,-0.186307 -0.270602,-0.163017 -0.295201,-0.163019 -0.295203,-0.163017 -0.319801,-0.139731 -0.295201,-0.116441 -0.319802,-0.09315 -0.319801,-0.06986 -0.319804,-0.09315 -0.3444,-0.04658 -0.319802,-0.04658 -0.344403,-0.02329 H 22.37482 v 0 h -0.344401 l -0.319801,0.02329 -0.319802,0.04658 -0.344402,0.04658 -0.319802,0.09315 -0.319802,0.06986 -0.344402,0.09315 -0.295201,0.116441 -0.295203,0.139731 -0.319801,0.163017 -0.270602,0.163019 -0.295201,0.163017 -0.270602,0.186307 -0.270602,0.209595 -0.246001,0.209596 -0.221399,0.232881 -0.246004,0.232884 -0.196799,0.232883 -0.196801,0.256172 -0.196801,0.27946 -0.172202,0.279459 -0.147599,0.27946 -0.147602,0.302748 -0.123,0.27946 -0.0984,0.302748 -0.0984,0.302748 -0.0738,0.302747 -0.0492,0.326039 -0.0492,0.326036 -0.0246,0.326036 v 0.302748 0 0.326036 l 0.0246,0.326036 0.0492,0.27946 0.0492,0.326038 0.0738,0.326036 0.0984,0.302748 0.0984,0.302748 0.123,0.302748 0.147602,0.279459 0.147599,0.27946 0.172202,0.27946 0.196801,0.256172 0.196801,0.279459 0.196799,0.232884 0.246004,0.232883 0.221399,0.232884 0.246001,0.209593 0.270602,0.186307 0.270602,0.209596 0.295201,0.163017 0.270602,0.163019 0.319801,0.163019 0.295203,0.116441 0.295201,0.11644 0.344402,0.116443 0.319802,0.09315 0.319802,0.06986 0.344402,0.04658 0.319802,0.04658 0.319801,0.02329 h 0.344401 v 0 h 0.344402 l 0.344403,-0.02329 0.319802,-0.04658 0.3444,-0.04658 0.319804,-0.06986 0.319801,-0.09315 0.319802,-0.116443 0.295201,-0.11644 0.319801,-0.116441 0.295203,-0.163019 0.295201,-0.163019 0.270602,-0.163017 0.270602,-0.209596 0.246,-0.186307 0.270602,-0.209593 0.246001,-0.232884 0.196801,-0.232883 0.2214,-0.232884 0.221402,-0.279459 0.172201,-0.256172 0.172202,-0.27946 0.147599,-0.27946 0.147602,-0.279459 0.123,-0.302748 0.0984,-0.302748 0.0984,-0.302748 0.0984,-0.326036 0.0246,-0.326038 0.0492,-0.27946 0.0246,-0.326036 0.0246,-0.326036" style="fill:#ffffff;stroke:none;stroke-width:0.001" /> <path d="m 28.598654,26.281095 -0.0246,-0.326036 v -0.326038 l -0.0492,-0.302748 -0.0738,-0.326036 -0.0738,-0.302748 -0.0738,-0.302748 -0.123,-0.302748 -0.123003,-0.302747 -0.123,-0.27946 -0.147599,-0.27946 -0.196801,-0.27946 -0.196802,-0.27946 -0.172202,-0.256171 -0.2214,-0.232884 -0.221402,-0.232883 -0.246001,-0.232884 -0.246001,-0.209595 -0.246001,-0.209593 -0.270602,-0.186308 -0.295203,-0.186307 -0.2952,-0.163017 -0.270602,-0.139731 -0.319802,-0.139728 -0.319801,-0.116443 -0.319802,-0.116441 -0.319802,-0.06986 -0.319801,-0.06987 -0.344403,-0.04658 -0.319801,-0.04658 -0.344401,-0.02329 H 21.98122 v 0 h -0.344403 l -0.319802,0.02329 -0.344402,0.04658 -0.344403,0.04658 -0.319801,0.06987 -0.319802,0.06986 -0.319802,0.116441 -0.319801,0.116443 -0.295201,0.139728 -0.295203,0.139731 -0.2952,0.163017 -0.295201,0.186307 -0.246003,0.186308 -0.2706,0.209593 -0.246003,0.209595 -0.2214,0.232884 -0.246001,0.232883 -0.221402,0.232884 -0.1722,0.256171 -0.196801,0.27946 -0.196801,0.27946 -0.123001,0.27946 -0.147601,0.27946 -0.123001,0.302747 -0.123,0.302748 -0.0738,0.302748 -0.0738,0.302748 -0.0738,0.326036 -0.0492,0.302748 v 0.326038 l -0.0246,0.326036 v 0 l 0.0246,0.302748 v 0.326036 l 0.0492,0.326036 0.0738,0.302748 0.0738,0.326036 0.0738,0.30275 0.123,0.302748 0.123001,0.27946 0.147601,0.302748 0.123001,0.27946 0.196801,0.27946 0.196801,0.256171 0.1722,0.256172 0.221402,0.232881 0.246001,0.256172 0.2214,0.209595 0.246003,0.232884 0.2706,0.186307 0.246003,0.209593 0.295201,0.163019 0.2952,0.163019 0.295203,0.163017 0.295201,0.116443 0.319801,0.116441 0.319802,0.116441 0.319802,0.06987 0.319801,0.06987 0.344403,0.06986 0.344402,0.04658 h 0.319802 l 0.344403,0.02329 v 0 l 0.319801,-0.02329 h 0.344401 l 0.319801,-0.04658 0.344403,-0.06986 0.319801,-0.06987 0.319802,-0.06987 0.319802,-0.116441 0.319801,-0.116441 0.319802,-0.116443 0.270602,-0.163017 0.2952,-0.163019 0.295203,-0.163019 0.270602,-0.209593 0.246001,-0.186307 0.246001,-0.232884 0.246001,-0.209595 0.221402,-0.256172 0.2214,-0.232881 0.172202,-0.256172 0.196802,-0.256171 0.196801,-0.27946 0.147599,-0.27946 0.123,-0.302748 0.123003,-0.27946 0.123,-0.302748 0.0738,-0.30275 0.0738,-0.326036 0.0738,-0.302748 0.0492,-0.326036 v -0.326036 l 0.0246,-0.302748" style="fill:url(#linearGradient9177);fill-opacity:1;stroke:none;stroke-width:0.001" /> </g>',

"scull.svg": '<g style="clip-rule:evenodd;fill-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421" > <g id="g5" transform="translate(0,0)"> <g > <circle style="fill:#ffffff" r="150" cy="150" cx="150" /> <path d="m 150.485,0.001 c 49.5244,-0.30805092 97.99005,26.13918 124.885,67.66 29.14949,43.41669 32.66869,102.35469 9.029,148.98 -22.3226,45.72399 -69.26524,78.27982 -120.017,82.677 C 116.79963,304.27157 67.626954,284.53159 36.597,248.141 4.2284143,211.43134 -7.8772602,158.34647 5.079,111.186 18.20087,60.591626 59.782145,18.758853 110.292,5.321 c 13.07378,-3.5887368 26.6371,-5.36778112 40.193,-5.32 z m -0.919,16 C 104.07954,15.682674 59.676029,40.73106 36.035,79.522 10.237529,120.258 9.3382219,175.08668 33.754,216.66 c 22.507056,39.83833 66.53845,66.428 112.351,67.284 44.86675,1.74378 89.5149,-21.18229 114.552,-58.394 27.38615,-39.18451 30.93913,-93.31402 9.052,-135.793 C 249.0838,48.105271 205.50868,18.954337 159.041,16.3 c -3.15359,-0.209033 -6.31449,-0.309606 -9.475,-0.299 z" style="fill:#e3292e" /> </g> <g transform="translate(22.5864,24.9658)" > <g > <path style="fill:#e3292e" d="M 74.348,182.188 C 51.779,165.762 37.097,139.141 37.097,109.117 c 0,-49.847 40.47,-90.316 90.317,-90.316 49.846,0 90.316,40.469 90.316,90.316 0,29.933 -14.594,56.485 -37.048,72.922 0.156,0.531 0.24,1.093 0.24,1.675 v 41.61 c 0,3.28 -2.663,5.943 -5.943,5.943 h -11.886 c -3.281,0 -5.944,-2.663 -5.944,-5.943 v -30.908 c -1.285,0.448 -2.584,0.869 -3.895,1.26 v 29.648 c 0,3.28 -2.663,5.943 -5.943,5.943 h -11.886 c -3.28,0 -5.943,-2.663 -5.943,-5.943 V 199.41 c -0.688,0.016 -1.377,0.023 -2.068,0.023 -0.617,0 -1.232,-0.006 -1.845,-0.018 v 25.909 c 0,3.28 -2.663,5.943 -5.944,5.943 h -11.886 c -3.28,0 -5.943,-2.663 -5.943,-5.943 v -29.582 c -1.304,-0.385 -2.595,-0.799 -3.873,-1.241 v 30.823 c 0,3.28 -2.663,5.943 -5.944,5.943 H 80.093 c -3.28,0 -5.943,-2.663 -5.943,-5.943 v -41.61 c 0,-0.528 0.069,-1.039 0.198,-1.526 z" /> <g > <path style="fill:#ffffff" d="m 65.717,98.232 c 8.653,-0.138 51.752,29.726 51.752,36.504 -10e-4,6.779 -33.824,18.284 -52.545,4.385 -13.65,-10.134 -10.186,-40.715 0.793,-40.889 z" /> <g transform="matrix(-1,0,0,1,254.827,0)"> <path style="fill:#ffffff" d="m 65.717,98.232 c 8.653,-0.138 51.752,29.726 51.752,36.504 -10e-4,6.779 -33.824,18.284 -52.545,4.385 -13.65,-10.134 -10.186,-40.715 0.793,-40.889 z" /> </g> <g transform="translate(-7.05456,-2.59864)"> <path style="fill:#ffffff" d="m 134.468,155.392 c 0,0 -9.945,17.602 -9.945,25.146 0,5.489 4.456,9.945 9.945,9.945 5.489,0 9.945,-4.456 9.945,-9.945 0,-7.544 -9.945,-25.146 -9.945,-25.146 z" /> </g> </g> </g> </g> </g> </g>'
}

with open("iot_anomaly_detection_2.gns3", "r") as f:
    project = json.loads(f.read())

width = project["scene_width"]
height = project["scene_height"]

dx = width//2
dy = height//2

# use this line to create a default empty svg file
# svg = f'<svg xmlns="http://www.w3.org/2000/svg" width="{width}" height="{height}">\n'
# open with inkscape and import all the svg symbols
# save an read the file for the svg code of each symbol, and put them in the symbols_dict dictionary
# delete the imported symbols
# save the file as gns3_topology_template.svg
# now the correct svg headers are loaded

with open("gns3_topology_template.svg", "r") as f:
    svg = f.read()
svg = svg.replace("</svg>", "")

topology = project["topology"]

for drawing in topology["drawings"]:
    x = drawing["x"] + dx
    y = drawing["y"] + dy
    try:
        text = re.findall(r"(<text.*</text>).*", drawing["svg"], flags=re.DOTALL)[0]
        text = text.replace("<text", f'<text x="{x}" y="{y}"') + "\n"
    except Exception:  # yes
        print("!")
        continue
    svg += text

node_coords = dict()
for node in topology["nodes"]:
    x = node["x"] + dx
    y = node["y"] + dy
    node_coords[node["node_id"]] = (x, y)

    try:
        # for scale, check http://w3.unpocodetodo.info/svg/matrix.php
        # example: transform="matrix(10.19997959,0,0,10.19995118,0.00612242,3.3238395e-4)"
        symbol_svg = symbols_dict[node["symbol"].split("/")[-1]].replace('transform="translate(0,0)"', f'transform="translate({x},{y})"') + "\n"
    except KeyError:
        print(f'Symbol \'{node["symbol"]}\' not found, replacing with circle')
        symbol_svg = f'<circle cx="{x}" cy="{y}" r="40" stroke="black" stroke-width="3" fill="red" />' + "\n"
    svg += symbol_svg

    label = node["label"]
    lx = label["x"] # relative to x
    ly = label["y"] # relative to y
    lt = label["text"]
    svg += f'<text x="{x+lx}" y="{y+ly}" fill="blue">{lt}</text>\n'


for link in topology["links"]:
    l1, l2 = link["nodes"]
    l1x, l1y = node_coords[l1["node_id"]]
    l2x, l2y = node_coords[l2["node_id"]]
    svg += f'<line x1="{l1x}" y1="{l1y}" x2="{l2x}" y2="{l2y}" style="stroke:rgb({random.randint(0,255)},{random.randint(0,255)},{random.randint(0,255)});stroke-width:10"/>\n'

svg += '</svg>\n'
with open("gns3_topology_out.svg", "w") as of:
    of.write(svg)
